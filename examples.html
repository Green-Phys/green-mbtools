<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Source code documentation" href="source_code_doc.html" /><link rel="prev" title="Installation" href="install.html" />
        <link rel="prefetch" href="_static/rosetta.png" as="image" />

    <link rel="shortcut icon" href="_static/rosetta.png"/><!-- Generated with Sphinx 8.2.3 and Furo 2025.07.19 -->
        <title>Examples - Green MBTools</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=25af2a20" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=25e12dd6" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Green MBTools</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/rosetta.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Green MBTools</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Examples</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="source_code_doc.html">Source code documentation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Source code documentation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="green_mbtools.mint.html">green_mbtools.mint</a></li>
<li class="toctree-l2"><a class="reference internal" href="green_mbtools.pesto.html">green_mbtools.pesto</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Green-Phys/green-mbtools">Github</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/examples.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h1>
<p>Several <a class="reference external" href="https://github.com/Green-Phys/green-mbtools/tree/master/examples">example scripts</a> are provided in the
Github repo of the green-mbtools package, particularly for the post-processing of Green output.
Here, we will go over some of the basic cases.</p>
<section id="initialization">
<h2>Initialization<a class="headerlink" href="#initialization" title="Link to this heading">¶</a></h2>
<p>For analyzing the output of Green’s function simulation using, e.g. GW, GF2, or self-energy embedding theory,
we use the <code class="docutils literal notranslate"><span class="pre">MB_post</span></code> class from <code class="docutils literal notranslate"><span class="pre">green_mbtools.pesto.mb</span></code>.
The script <a class="reference external" href="https://github.com/Green-Phys/green-mbtools/blob/master/examples/MB_post_example.py">examples/MB_post_example.py</a>
demonstrates the key steps in initializing the post-processing class:</p>
<ol class="arabic">
<li><p>Read the input and output files from a Green simulation, and initialize the many-body post processing class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">green_mbtools.pesto</span><span class="w"> </span><span class="kn">import</span> <span class="n">mb</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">fname_inp</span> <span class="o">=</span> <span class="s1">&#39;/path/to/input.h5&#39;</span>
    <span class="n">fname_sim</span> <span class="o">=</span> <span class="s1">&#39;/path/to/sim.h5&#39;</span>
    <span class="n">ir_file</span> <span class="o">=</span> <span class="s1">&#39;/path/to/ir.h5&#39;</span>

    <span class="n">mb_obj</span> <span class="o">=</span> <span class="n">mb</span><span class="o">.</span><span class="n">initialize_MB_post</span><span class="p">(</span><span class="n">sim_path</span><span class="o">=</span><span class="n">fname_sim</span><span class="p">,</span> <span class="n">input_path</span><span class="o">=</span><span class="n">fname_inp</span><span class="p">,</span> <span class="n">ir_file</span><span class="o">=</span><span class="n">ir_file</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Access Green’s function, self-energy, and other information</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="c1"># ... initialization</span>

    <span class="n">mu</span> <span class="o">=</span> <span class="n">mb_obj</span><span class="o">.</span><span class="n">mu</span><span class="p">()</span>  <span class="c1"># chemical potential</span>
    <span class="n">gtau</span> <span class="o">=</span> <span class="n">mb_obj</span><span class="o">.</span><span class="n">gtau</span><span class="p">()</span>  <span class="c1"># Green&#39;s function</span>
    <span class="n">sigma_tau</span> <span class="o">=</span> <span class="n">mb_obj</span><span class="o">.</span><span class="n">sigma</span>  <span class="c1"># self-energy on imaginary-time axis</span>
    <span class="n">dm</span> <span class="o">=</span> <span class="n">mb_obj</span><span class="o">.</span><span class="n">dm</span><span class="p">()</span>  <span class="c1"># get density matrix from Green&#39;s function</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="matsubara-transformation">
<h2>Matsubara Transformation<a class="headerlink" href="#matsubara-transformation" title="Link to this heading">¶</a></h2>
<p>We are often interested in visualizing the Green’s function and self-energy on the Matsubara frequency or <span class="math notranslate nohighlight">\(i\omega\)</span> axis
rather than the imaginary-time or <span class="math notranslate nohighlight">\(\tau\)</span> axis.
As the data in Green software package is stored on sparse grids also known as the intermediate representation (IR) grids,
we use the information from the IR grid file to execute the <span class="math notranslate nohighlight">\(\tau \leftrightarrow i\omega\)</span> transformation.</p>
<p>Once an <code class="docutils literal notranslate"><span class="pre">MB_post</span></code> object is initialized, the transformation can be performed simply as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="c1"># ... initialization</span>

    <span class="c1"># tau to omega transform</span>
    <span class="n">sigma_iw</span> <span class="o">=</span> <span class="n">mb_obj</span><span class="o">.</span><span class="n">ir</span><span class="o">.</span><span class="n">tau_to_w</span><span class="p">(</span><span class="n">sigma_tau</span><span class="p">)</span>
    <span class="n">g_iw</span> <span class="o">=</span> <span class="n">mb_obj</span><span class="o">.</span><span class="n">ir</span><span class="o">.</span><span class="n">tau_to_w</span><span class="p">(</span><span class="n">gtau</span><span class="p">)</span>
    <span class="c1"># back transform</span>
    <span class="n">sigma_tau_back</span> <span class="o">=</span> <span class="n">mb_obj</span><span class="o">.</span><span class="n">ir</span><span class="o">.</span><span class="n">w_to_tau</span><span class="p">(</span><span class="n">sigma_iw</span><span class="p">)</span>
    <span class="n">gtau_back</span> <span class="o">=</span> <span class="n">mb_obj</span><span class="o">.</span><span class="n">ir</span><span class="o">.</span><span class="n">w_to_tau</span><span class="p">(</span><span class="n">g_iw</span><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference external" href="https://github.com/Green-Phys/green-mbtools/blob/master/examples/IR_transform.py">examples/IR_transform.py</a> script
also shows how such a transformation can be performed without initializing the <code class="docutils literal notranslate"><span class="pre">MB_post</span></code> object for one of the testing
data files.
The IR transform is supported by the class <code class="docutils literal notranslate"><span class="pre">IR_factory</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="c1"># ... initialization</span>

    <span class="c1"># Data files</span>
    <span class="n">sim_file</span> <span class="o">=</span> <span class="s1">&#39;../tests/test_data/H2_GW/sim.h5&#39;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">sim_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">it</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s2">&quot;iter&quot;</span><span class="p">][()]</span>
    <span class="n">G_tau</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s2">&quot;iter&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/G_tau/data&quot;</span><span class="p">][()]</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="nb">complex</span><span class="p">)</span>
    <span class="n">tau_mesh</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s2">&quot;iter&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/G_tau/mesh&quot;</span><span class="p">][()]</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1"># Here the H2 GW simulation uses lambda = 1e4</span>
    <span class="n">ir_file</span> <span class="o">=</span> <span class="s1">&#39;../tests/test_data/ir_grid/1e4.h5&#39;</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">tau_mesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># inverse temperature in simulation</span>
    <span class="n">nts</span> <span class="o">=</span> <span class="n">tau_mesh</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">my_ir</span> <span class="o">=</span> <span class="n">ir</span><span class="o">.</span><span class="n">IR_factory</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">ir_file</span><span class="p">)</span>

    <span class="c1"># Fourier transform from G(tau) to  G(iw_n)</span>
    <span class="n">G_iw</span> <span class="o">=</span> <span class="n">my_ir</span><span class="o">.</span><span class="n">tau_to_w</span><span class="p">(</span><span class="n">G_tau</span><span class="p">)</span>
    <span class="c1"># Fourier transform from G(iw_n) to G(tau)</span>
    <span class="n">G_tau_2</span> <span class="o">=</span> <span class="n">my_ir</span><span class="o">.</span><span class="n">w_to_tau</span><span class="p">(</span><span class="n">G_iw</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="analytic-continuation">
<h2>Analytic continuation<a class="headerlink" href="#analytic-continuation" title="Link to this heading">¶</a></h2>
<p>One of the primary steps in the post-processing of Green’s function data is analytic continuation (AC) of the results from
imaginary time and frequency axis to the real frequency axis.
The <cite>green-mbtools.pesto</cite> module supports several implementations for AC based on theory of:</p>
<ul class="simple">
<li><p>Nevanlinna functions, see <a class="reference external" href="https://github.com/Green-Phys/tree/master/examples/nevanlinna.py">examples/nevanlinna.py</a>,</p></li>
<li><p>Caratheodory functions, and</p></li>
<li><p>Pole estimation and semi-definite relaxation, see <a class="reference external" href="https://github.com/Green-Phys/tree/master/examples/es_nevanlinna.py">examples/es_nevanlinna.py</a>.</p></li>
</ul>
<p>In addition, an interface to the <a class="reference external" href="https://github.com/CQMP/Maxent">Maxent</a> AC library is also provided
(see <a class="reference external" href="https://github.com/Green-Phys/green-mbtools/tree/master/examples/maxent.py">examples/maxent.py</a>.</p>
<p>Nevanlinna AC is one of the more robust approaches in our opinion and a direct interface is provided in the <code class="docutils literal notranslate"><span class="pre">MB_post</span></code> class.
Continuing with the above examples, we can directly obtain the spectral function on the real axis using:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="c1"># ... initialization</span>

    <span class="c1"># w_min and w_max: min and max real frequency bracket (in a.u.)</span>
    <span class="c1"># n_real: number of frequency points to consider -- more poitns = smoother plots</span>
    <span class="c1"># eta: Broadening parameter</span>
    <span class="n">n_real</span> <span class="o">=</span> <span class="mi">10001</span>
    <span class="n">w_min</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.0</span>
    <span class="n">w_max</span> <span class="o">=</span> <span class="mf">5.0</span>
    <span class="n">eta</span> <span class="o">=</span> <span class="mf">0.01</span>
    <span class="n">freqs</span><span class="p">,</span> <span class="n">Aw</span> <span class="o">=</span> <span class="n">mb_obj</span><span class="o">.</span><span class="n">AC_nevanlinna</span><span class="p">(</span><span class="n">n_real</span><span class="o">=</span><span class="n">n_real</span><span class="p">,</span> <span class="n">w_min</span><span class="o">=</span><span class="n">w_min</span><span class="p">,</span> <span class="n">w_max</span><span class="o">=</span><span class="n">w_max</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="n">eta</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Most AC implementations use parallelization using multiprocessing utilities in python.
As a result, analytic continuation should always be placed inside the
<code class="code docutils literal notranslate"><span class="pre">if</span> <span class="pre">__name__</span> <span class="pre">==</span> <span class="pre">&quot;__main__&quot;:</span></code> block.</p>
</div>
</section>
<section id="wannier-interpolation">
<h2>Wannier interpolation<a class="headerlink" href="#wannier-interpolation" title="Link to this heading">¶</a></h2>
<p>For solid-state systems, simulations are generally performed on evenly sampled grid-points in the first Brillouin zone
in the reciprocal space.
However, the spectral function and band structure are generally desirable along a special, high-symmetry path in the same
Brillouin zone.
This is facilitated by <cite>k</cite>-point or Wannier interpolation, which is provided by <code class="docutils literal notranslate"><span class="pre">green_mbtools.pesto.ft</span></code> library.</p>
<p>Examples for interpolating the mean-field (e.g., DFT, Hartree-Fock) and the correlated calculation (e.g., GW, GF2, SEET)
results are provided in
<a class="reference external" href="https://github.com/Green-Phys/green-mbtools/tree/master/examples/winter_mean_field.py">examples/winter_mean_field.py</a>
and
<a class="reference external" href="https://github.com/Green-Phys/green-mbtools/tree/master/examples/winter_correlated.py">examples/winter_correlated.py</a>,
respectively.</p>
<p>Following the above exmple, once the <code class="docutils literal notranslate"><span class="pre">MB_post</span></code> object is initialized, the interpolation can be performed directly using
the function <code class="docutils literal notranslate"><span class="pre">wannier_interpolation</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ase.spacegroup</span><span class="w"> </span><span class="kn">import</span> <span class="n">crystal</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">green_mbtools.pest</span><span class="w"> </span><span class="kn">import</span> <span class="n">mb</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="c1"># initialization</span>

    <span class="c1"># obtain high-symmetry path for fictitious H2 solid example using ase</span>
    <span class="n">cc</span> <span class="o">=</span> <span class="n">crystal</span><span class="p">(</span>
        <span class="n">symbols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">],</span>
        <span class="n">basis</span><span class="o">=</span><span class="p">[(</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)],</span>
        <span class="n">spacegroup</span><span class="o">=</span><span class="n">group</span><span class="p">,</span>
        <span class="n">cellpar</span><span class="o">=</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">],</span> <span class="n">primitive_cell</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">cell</span><span class="o">.</span><span class="n">bandpath</span><span class="p">(</span><span class="s1">&#39;GXMGR&#39;</span><span class="p">,</span> <span class="n">npoints</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">kpts_inter</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">kpts</span>

    <span class="c1"># Obtain interpolated Green&#39;s function, self-energy, tau-mesh, Fock and overlap matrix</span>
    <span class="n">G_tk_int</span><span class="p">,</span> <span class="n">Sigma_tk_int</span><span class="p">,</span> <span class="n">tau_mesh</span><span class="p">,</span> <span class="n">Fk_int</span><span class="p">,</span> <span class="n">Sk_int</span> <span class="o">=</span> <span class="n">MB</span><span class="o">.</span><span class="n">wannier_interpolation</span><span class="p">(</span>
        <span class="n">kpts_inter</span><span class="p">,</span> <span class="n">hermi</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="n">debug</span>
    <span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The accuracy of interpolation depends on the density of the original Brillouin zone grid.
To reduce the errors, we recommend using PySCF to directly calculate the one-body Hamiltonain and the
overlap matrix along the high-symmetry path rather than interpolation. See, e.g.,
<a class="reference external" href="https://github.com/Green-Phys/green-mbtools/tree/master/examples/useful_scripts/nvnl_winter_analysis.py">examples/useful_scripts/nvnl_winter_analysis.py</a>.</p>
</div>
</section>
<section id="other-useful-scripts">
<h2>Other useful scripts<a class="headerlink" href="#other-useful-scripts" title="Link to this heading">¶</a></h2>
<p>For practical application, a combination of initialization, interpolation and analytic continuation is required.
We provide several python scripts to automate these tasks for solid-state and molecular systems.
These are available in the
<a class="reference external" href="https://github.com/Green-Phys/green-mbtools/tree/master/examples/useful_scripts">examples/useful_scripts</a> directory.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="source_code_doc.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Source code documentation</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="install.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Installation</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Green-Phys
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Examples</a><ul>
<li><a class="reference internal" href="#initialization">Initialization</a></li>
<li><a class="reference internal" href="#matsubara-transformation">Matsubara Transformation</a></li>
<li><a class="reference internal" href="#analytic-continuation">Analytic continuation</a></li>
<li><a class="reference internal" href="#wannier-interpolation">Wannier interpolation</a></li>
<li><a class="reference internal" href="#other-useful-scripts">Other useful scripts</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=b489f392"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=46bd48cc"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>